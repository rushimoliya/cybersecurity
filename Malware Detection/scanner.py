# scanner.py
import subprocess
import os
from config import CLAMSCAN_PATH, LOG_FILE

def scan_file(file_path):
    """Scan a single file using ClamAV."""
    print(f"üîç Scanning file: {file_path}")
    result = subprocess.run([CLAMSCAN_PATH, file_path], capture_output=True, text=True)
    
    with open(LOG_FILE, "a") as log:
        log.write(result.stdout + "\n")
    
    if "FOUND" in result.stdout:
        print(f"‚ö†Ô∏è VIRUS DETECTED in {file_path}!")
    else:
        print(f"‚úÖ File is clean: {file_path}")

def scan_folder(folder_path):
    """Scan an entire folder recursively."""
    print(f"üîç Scanning folder: {folder_path}")
    result = subprocess.run([CLAMSCAN_PATH, "--recursive", folder_path], capture_output=True, text=True)
    
    with open(LOG_FILE, "a") as log:
        log.write(result.stdout + "\n")

    print(result.stdout)

if __name__ == "__main__":
    folder_to_scan = input("Enter the folder path to scan: ")
    if os.path.exists(folder_to_scan):
        scan_folder(folder_to_scan)
    else:
        print("‚ùå Invalid folder path.")
